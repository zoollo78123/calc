<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>â„ï¸ë°±ì—° ê´€ë¦¬ ì‹œìŠ¤í…œâ„ï¸</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background: #000; color: #fff; display: flex; justify-content: center; padding: 20px; margin: 0; }
        .container { width: 100%; max-width: 550px; background: #111; padding: 25px; border: 1px solid #333; border-radius: 15px; box-shadow: 0 0 20px rgba(0,212,255,0.1); }
        h1 { text-align: center; letter-spacing: 12px; color: #fff; margin-bottom: 20px; font-size: 24px; }
        .section { background: #1a1a1a; padding: 15px; border-radius: 10px; margin-bottom: 12px; border: 1px solid #222; }
        .section-title { font-size: 13px; color: #00d4ff; margin-bottom: 12px; font-weight: bold; border-left: 3px solid #00d4ff; padding-left: 10px; }
        .row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        label { font-size: 13px; color: #ccc; }
        input { width: 130px; padding: 8px; background: #000; border: 1px solid #333; color: #fff; text-align: right; border-radius: 5px; outline: none; font-size: 14px; }
        input:focus { border-color: #00d4ff; }
        .log-input { width: 100%; text-align: left; margin-bottom: 10px; box-sizing: border-box; }
        .btn-submit { width: 100%; padding: 15px; background: #00d4ff; color: #000; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 16px; }
        .result-container { background: #fff; color: #000; padding: 20px; border-radius: 10px; margin-top: 20px; }
        .total-val { font-size: 22px; font-weight: 900; color: #d63031; }
        #admin_logs { margin-top: 20px; background: #000; padding: 15px; border-radius: 10px; border: 1px solid #333; font-size: 13px; max-height: 400px; overflow-y: auto; }
    </style>
</head>
<body>

<div class="container">
    <h1>â„ï¸ë°±ì—°â„ï¸</h1>

    <div class="section">
        <div class="section-title">ê¸°ë³¸ í’ˆëª©</div>
        <div class="row"><label>C4 ìˆ˜ëŸ‰ [5ê°œâ†‘ / ê°œë‹¹ 5ì–µ]</label><input type="number" id="c4" oninput="calc()"></div>
        <div class="row"><label>ê²€ì€ëˆ ìˆ˜ëŸ‰ [ê°œë‹¹ 1ë§Œ]</label><input type="number" id="bm" oninput="calc()"></div>
    </div>

    <div class="section">
        <div class="section-title">ë§ˆì•½ ë° ìœ„í</div>
        <div class="row"><label>ë°€ê°€ë£¨ [ì„¸íŠ¸ / 3ì–µ]</label><input type="number" id="flour" oninput="calc()"></div>
        <div class="row"><label>ìƒ‰ì¢…ì´ [ì„¸íŠ¸ / 3ì–µ]</label><input type="number" id="paper" oninput="calc()"></div>
    </div>

    <div class="section">
        <div class="section-title">ì´ê¸° ë° ë¬´ê¸°ë¥˜</div>
        <div class="row"><label>ì¹´ë¹ˆì†Œì´ [3ì–µ]</label><input type="number" id="g1" oninput="calc()"></div>
        <div class="row"><label>ì–´ì°íŠ¸ / ì»´ë±ƒ [1.5ì–µ]</label><input type="number" id="g2" oninput="calc()"></div>
        <div class="row"><label>SMG ì¢…ë¥˜ [2ì–µ]</label><input type="number" id="g3" oninput="calc()"></div>
        <div class="row"><label>íƒ„ì•½ [100ë°œë‹¹ 2000ë§Œì›]</label><input type="number" id="ammo" oninput="calc()"></div>
        <div class="row"><label>ê·¼ì ‘ë¬´ê¸° [1ì–µ]</label><input type="number" id="melee" oninput="calc()"></div>
    </div>

    <div class="result-container">
        <div class="row" style="color:#000;"><label>ì´ ë°›ì„ ê¸ˆì•¡</label><span id="total_r" class="total-val">0ì›</span></div>
        <div class="row" style="color:#000;"><label>ì´ ê³µê³„ ì…ê¸ˆì•¡</label><span id="total_b" style="font-weight:bold; color:#0984e3;">0ì›</span></div>
    </div>

    <div class="section" style="margin-top:20px;">
        <div class="section-title">ğŸ“ íŒë§¤ ì¥ë¶€ ê¸°ë¡</div>
        <input type="text" id="log_seller" class="log-input" placeholder="íŒë§¤ì ì´ë¦„/ê³ ë²ˆ">
        <input type="text" id="log_buyer" class="log-input" placeholder="êµ¬ë§¤ì ì´ë¦„/ê³ ë²ˆ">
        <input type="text" id="log_link" class="log-input" placeholder="ë¡œê·¸ ë©”ì‹œì§€ ë§í¬ ë¶™ì—¬ë„£ê¸°">
        <button class="btn-submit" onclick="submitLog()">ê¸°ë¡ ì „ì†¡í•˜ê¸°</button>
    </div>

    <div class="section-title" style="margin-top:30px;">ğŸ“Š ì‹¤ì‹œê°„ ì¥ë¶€ í˜„í™©</div>
    <div id="admin_logs">ê¸°ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
</div>

<script>
    // Firebase ì„¤ì •
    const firebaseConfig = {
        apiKey: "AIzaSyBsXbrHi8hMWvzC6wj99bZtdqzXHETXOUU",
        authDomain: "backyeon.firebaseapp.com",
        databaseURL: "https://backyeon-default-rtdb.firebaseio.com",
        projectId: "backyeon",
        storageBucket: "backyeon.firebasestorage.app",
        messagingSenderId: "811495642258",
        appId: "1:811495642258:web:ba63782be82e8a9d6024be"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function formatWon(money) {
        money = Math.floor(money);
        if (money === 0) return "0ì›";
        let eok = Math.floor(money / 100000000);
        let man = Math.floor((money % 100000000) / 10000);
        return (eok > 0 ? eok + "ì–µ " : "") + (man > 0 ? man + "ë§Œ " : "") + "ì›";
    }

    function calc() {
        const getV = (id) => Number(document.getElementById(id).value) || 0;

        const c4_r = getV('c4') >= 5 ? getV('c4') * 500000000 : 0;
        const bm_r = (getV('bm') * 9000) * 0.8;
        const item_r = (getV('flour') + getV('paper')) * 300000000 * 0.7;
        const gun_r = (getV('g1') * 300000000) + (getV('g2') * 150000000) + (getV('g3') * 200000000) + (getV('ammo') * 200000) + (getV('melee') * 100000000);
        
        const total_r = c4_r + bm_r + item_r + gun_r;

        const c4_b = (getV('c4') * 500000000) * 0.3;
        const bm_b = ((getV('bm') * 9000) * 0.2) * 0.3;
        const item_b = ((getV('flour') + getV('paper')) * 300000000 * 0.9 * 0.2) * 0.3;
        const gun_b = gun_r * 0.3;

        const total_b = c4_b + bm_b + item_b + gun_b;

        document.getElementById('total_r').innerText = formatWon(total_r);
        document.getElementById('total_b').innerText = formatWon(total_b);
    }

    function submitLog() {
        const seller = document.getElementById('log_seller').value;
        const buyer = document.getElementById('log_buyer').value;
        const link = document.getElementById('log_link').value;
        const amount = document.getElementById('total_r').innerText;

        if(!seller || !buyer || !link || amount === "0ì›") {
            alert("ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  ê¸ˆì•¡ì„ í™•ì¸í•´ì£¼ì„¸ìš”!"); return;
        }

        database.ref('logs').push({
            date: new Date().toLocaleString(),
            seller: seller,
            buyer: buyer,
            amount: amount,
            link: link
        }).then(() => {
            alert("ì¥ë¶€ ê¸°ë¡ ì„±ê³µ! â„ï¸");
            document.getElementById('log_buyer').value = "";
            document.getElementById('log_link').value = "";
        });
    }

    database.ref('logs').on('value', (snapshot) => {
        const logBox = document.getElementById('admin_logs');
        logBox.innerHTML = "";
        const data = snapshot.val();
        if(!data) { logBox.innerHTML = "ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤."; return; }
        
        Object.keys(data).reverse().forEach(key => {
            const item = data[key];
            const div = document.createElement('div');
            div.style.borderBottom = "1px solid #222";
            div.style.padding = "10px 0";
            div.innerHTML = `
                <div style="color:#00d4ff; font-size:11px;">[${item.date}]</div>
                <div><b>${item.seller}</b> â” <b>${item.buyer}</b></div>
                <div style="color:#ff7675; font-weight:bold;">ê¸ˆì•¡: ${item.amount}</div>
                <a href="${item.link}" target="_blank" style="color:#888; font-size:11px;">[ë¡œê·¸ ë§í¬ í™•ì¸]</a>
            `;
            logBox.appendChild(div);
        });
    });
</script>
</body>
</html>